
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>视图组Viewsets · GitBook学习笔记</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="nick">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="routers.html" />
    
    
    <link rel="prev" href="gviews.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">安装介绍</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../home/install.html">
            
                <a href="../home/install.html">
            
                    
                        <b>1.2.</b>
                    
                    安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../home/example.html">
            
                <a href="../home/example.html">
            
                    
                        <b>1.3.</b>
                    
                    举例
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">快速上手</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../quickstart/project.html">
            
                <a href="../quickstart/project.html">
            
                    
                        <b>2.1.</b>
                    
                    创建项目
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../quickstart/serializers.html">
            
                <a href="../quickstart/serializers.html">
            
                    
                        <b>2.2.</b>
                    
                    序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../quickstart/views.html">
            
                <a href="../quickstart/views.html">
            
                    
                        <b>2.3.</b>
                    
                    视图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../quickstart/urls.html">
            
                <a href="../quickstart/urls.html">
            
                    
                        <b>2.4.</b>
                    
                    路由
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../quickstart/settings.html">
            
                <a href="../quickstart/settings.html">
            
                    
                        <b>2.5.</b>
                    
                    Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="../quickstart/testing.html">
            
                <a href="../quickstart/testing.html">
            
                    
                        <b>2.6.</b>
                    
                    测试API
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">教程</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../tutorial/serialization.html">
            
                <a href="../tutorial/serialization.html">
            
                    
                        <b>3.1.</b>
                    
                    序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../tutorial/req-resp.html">
            
                <a href="../tutorial/req-resp.html">
            
                    
                        <b>3.2.</b>
                    
                    Requests & Responses
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../tutorial/classview.html">
            
                <a href="../tutorial/classview.html">
            
                    
                        <b>3.3.</b>
                    
                    类视图
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../tutorial/auth-perms.html">
            
                <a href="../tutorial/auth-perms.html">
            
                    
                        <b>3.4.</b>
                    
                    认证和权限
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../tutorial/hyperlink.html">
            
                <a href="../tutorial/hyperlink.html">
            
                    
                        <b>3.5.</b>
                    
                    关系和超链接
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../tutorial/routers.html">
            
                <a href="../tutorial/routers.html">
            
                    
                        <b>3.6.</b>
                    
                    视图集合和路由
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../tutorial/coreapi.html">
            
                <a href="../tutorial/coreapi.html">
            
                    
                        <b>3.7.</b>
                    
                    coreapi
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">API 指南</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="requests.html">
            
                <a href="requests.html">
            
                    
                        <b>4.1.</b>
                    
                    Requests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="responses.html">
            
                <a href="responses.html">
            
                    
                        <b>4.2.</b>
                    
                    Responses
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="views.html">
            
                <a href="views.html">
            
                    
                        <b>4.3.</b>
                    
                    视图Views
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="gviews.html">
            
                <a href="gviews.html">
            
                    
                        <b>4.4.</b>
                    
                    通用视图Generic views
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.5" data-path="viewsets.html">
            
                <a href="viewsets.html">
            
                    
                        <b>4.5.</b>
                    
                    视图组Viewsets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="routers.html">
            
                <a href="routers.html">
            
                    
                        <b>4.6.</b>
                    
                    路由器Routers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="parsers.html">
            
                <a href="parsers.html">
            
                    
                        <b>4.7.</b>
                    
                    解析器Parsers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="renderers.html">
            
                <a href="renderers.html">
            
                    
                        <b>4.8.</b>
                    
                    渲染器Renderers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="serializers.html">
            
                <a href="serializers.html">
            
                    
                        <b>4.9.</b>
                    
                    序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="serializersfield.html">
            
                <a href="serializersfield.html">
            
                    
                        <b>4.10.</b>
                    
                    Serializer fields
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.11" data-path="serializersrelat.html">
            
                <a href="serializersrelat.html">
            
                    
                        <b>4.11.</b>
                    
                    Serializer relations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.12" data-path="validators.html">
            
                <a href="validators.html">
            
                    
                        <b>4.12.</b>
                    
                    校验器Validators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.13" data-path="authentication.html">
            
                <a href="authentication.html">
            
                    
                        <b>4.13.</b>
                    
                    身份验证
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.14" data-path="permissions.html">
            
                <a href="permissions.html">
            
                    
                        <b>4.14.</b>
                    
                    权限
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.15" data-path="throttling.html">
            
                <a href="throttling.html">
            
                    
                        <b>4.15.</b>
                    
                    限流Throttling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.16" data-path="filtering.html">
            
                <a href="filtering.html">
            
                    
                        <b>4.16.</b>
                    
                    过滤
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.17" data-path="pagination.html">
            
                <a href="pagination.html">
            
                    
                        <b>4.17.</b>
                    
                    分页
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.18" data-path="versioning.html">
            
                <a href="versioning.html">
            
                    
                        <b>4.18.</b>
                    
                    API 版本化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.19" data-path="cnegotiation.html">
            
                <a href="cnegotiation.html">
            
                    
                        <b>4.19.</b>
                    
                    内容协商Content negotiation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.20" data-path="metadata.html">
            
                <a href="metadata.html">
            
                    
                        <b>4.20.</b>
                    
                    元数据
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.21" data-path="schemas.html">
            
                <a href="schemas.html">
            
                    
                        <b>4.21.</b>
                    
                    Schemas
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.22" data-path="formatsuffixes.html">
            
                <a href="formatsuffixes.html">
            
                    
                        <b>4.22.</b>
                    
                    Format suffixes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.23" data-path="urls.html">
            
                <a href="urls.html">
            
                    
                        <b>4.23.</b>
                    
                    Returning URLs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.24" data-path="exceptions.html">
            
                <a href="exceptions.html">
            
                    
                        <b>4.24.</b>
                    
                    异常处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.25" data-path="statuscodes.html">
            
                <a href="statuscodes.html">
            
                    
                        <b>4.25.</b>
                    
                    状态码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.26" data-path="testing.html">
            
                <a href="testing.html">
            
                    
                        <b>4.26.</b>
                    
                    测试
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.27" data-path="settings.html">
            
                <a href="settings.html">
            
                    
                        <b>4.27.</b>
                    
                    Settings
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">最佳实践</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../topics/docs.html">
            
                <a href="../topics/docs.html">
            
                    
                        <b>5.1.</b>
                    
                    API文档生成
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >视图组Viewsets</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="&#x89C6;&#x56FE;&#x7EC4;viewsets">&#x89C6;&#x56FE;&#x7EC4;Viewsets</h2>
<blockquote>
<p>&#x8DEF;&#x7531;&#x5668;&#x51B3;&#x5B9A;&#x4F7F;&#x7528;&#x54EA;&#x4E2A;&#x63A7;&#x5236;&#x5668;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x540E;&#xFF0C;&#x63A7;&#x5236;&#x5668;&#x8D1F;&#x8D23;&#x89E3;&#x6790;&#x8BF7;&#x6C42;&#xFF0C;&#x751F;&#x6210;&#x76F8;&#x5E94;&#x7684;&#x8F93;&#x51FA;&#x3002;<br>&#x2014;&#x2014; Ruby on Rails Documentation</p>
</blockquote>
<p>&#x70B9;&#x51FB;&#x6B64;&#x5904;<a href="http://guides.rubyonrails.org/action_controller_overview.html" target="_blank">&#x67E5;&#x770B;&#x6587;&#x6863;</a>&#x3002;</p>
<p>Django REST framework&#x5141;&#x8BB8;&#x60A8;&#x5C06;&#x4E00;&#x7EC4;&#x76F8;&#x5173;&#x89C6;&#x56FE;&#x7684;&#x903B;&#x8F91;&#x7EC4;&#x5408;&#x5230;&#x4E00;&#x4E2A;&#x540D;&#x4E3A;<code>ViewSet</code>&#x7684;&#x7C7B;&#x4E2D;&#x3002;&#x5728;&#x5176;&#x4ED6;&#x6846;&#x67B6;&#x4E2D;&#xFF0C;&#x60A8;&#x53EF;&#x80FD;&#x4F1A;&#x53D1;&#x73B0;&#x6982;&#x5FF5;&#x4E0A;&#x7C7B;&#x4F3C;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x540D;&#x4E3A;&quot;Resources&quot;&#x6216;&quot;Controllers&quot;&#x3002;</p>
<p>&#x4E00;&#x4E2A;<code>ViewSet</code>&#x7C7B;&#xFF0C;&#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x57FA;&#x4E8E;&#x7C7B;&#x7684;&#x89C6;&#x56FE;&#xFF0C;&#x5B83;&#x4E0D;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x5904;&#x7406;&#x65B9;&#x6CD5;&#xFF0C;&#x6BD4;&#x5982;<code>.get()</code>&#x6216;&#x8005;<code>.post()</code>&#xFF0C;&#x800C;&#x662F;&#x63D0;&#x4F9B;&#x4E86;&#x52A8;&#x4F5C;&#x65B9;&#x6CD5;&#x6765;&#x4EE3;&#x66FF;&#xFF0C;&#x6BD4;&#x5982;<code>.list()</code>&#x548C;<code>.create()</code>&#x3002;</p>
<p>&#x4E00;&#x4E2A;<code>ViewSet</code>&#x7C7B;&#xFF0C;&#x4F1A;&#x4F7F;&#x7528;<code>.as_view()</code>&#x65B9;&#x6CD5;&#x5C06;&#x5904;&#x7406;&#x65B9;&#x6CD5;&#x548C;&#x52A8;&#x4F5C;&#x65B9;&#x6CD5;&#x7ED1;&#x5B9A;&#x3002;</p>
<p>&#x76F8;&#x5173;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x4F4D;&#x7F6E;&#x5728;: <code>rest_framework.viewsets.ViewSetMixin</code></p>
<p>&#x901A;&#x5E38;&#xFF0C;&#x4E0D;&#x662F;&#x5728;urlconf&#x4E2D;&#x901A;&#x8FC7;viewset&#x6765;&#x663E;&#x793A;&#x7684;&#x6CE8;&#x518C;&#x4F60;&#x7684;&#x89C6;&#x56FE;&#xFF0C;&#x800C;&#x662F;&#x5C06;viewset&#x6CE8;&#x518C;&#x5230;router&#x7C7B;&#x4E2D;&#xFF0C;&#x8FD9;&#x5C06;&#x4F1A;&#x81EA;&#x52A8;&#x7684;&#x4E3A;&#x60A8;&#x786E;&#x5B9A;&#x9700;&#x8981;&#x7684;urlconf&#x3002;</p>
<h4 id="&#x4F8B;&#x5B50;">&#x4F8B;&#x5B50;</h4>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x6765;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;viewset&#xFF0C; &#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x53EF;&#x4EE5;&#x5217;&#x51FA;&#x6216;&#x8005;&#x83B7;&#x53D6;&#x7CFB;&#x7EDF;&#x4E2D;&#x7684;&#x7528;&#x6237;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> django.contrib.auth.models <span class="hljs-keyword">import</span> User
<span class="hljs-keyword">from</span> django.shortcuts <span class="hljs-keyword">import</span> get_object_or_404
<span class="hljs-keyword">from</span> myapps.serializers <span class="hljs-keyword">import</span> UserSerializer
<span class="hljs-keyword">from</span> rest_framework <span class="hljs-keyword">import</span> viewsets
<span class="hljs-keyword">from</span> rest_framework.response <span class="hljs-keyword">import</span> Response

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserViewSet</span><span class="hljs-params">(viewsets.ViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A simple ViewSet for listing or retrieving users.
    &quot;&quot;&quot;</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">list</span><span class="hljs-params">(self, request)</span>:</span>
        queryset = User.objects.all()
        serializer = UserSerializer(queryset, many=<span class="hljs-keyword">True</span>)
        <span class="hljs-keyword">return</span> Response(serializer.data)

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">retrieve</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        queryset = User.objects.all()
        user = get_object_or_404(queryset, pk=pk)
        serializer = UserSerializer(user)
        <span class="hljs-keyword">return</span> Response(serializer.data)
</code></pre>
<p>&#x5982;&#x679C;&#x6709;&#x5FC5;&#x8981;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x7ED1;&#x5B9A;&#x8FD9;&#x4E2A;viewset&#x5230;&#x4E24;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x89C6;&#x56FE;&#x91CC;&#x9762;&#xFF0C;&#x6BD4;&#x5982;&#x8FD9;&#x6837;&#xFF1A;</p>
<pre><code class="lang-python">user_list = UserViewSet.as_view({<span class="hljs-string">&apos;get&apos;</span>: <span class="hljs-string">&apos;list&apos;</span>})
user_detail = UserViewSet.as_view({<span class="hljs-string">&apos;get&apos;</span>: <span class="hljs-string">&apos;retrieve&apos;</span>})
</code></pre>
<p>&#x901A;&#x5E38;&#x6211;&#x4EEC;&#x4E0D;&#x4F1A;&#x8FD9;&#x6837;&#x505A;&#xFF0C;&#x800C;&#x662F;&#x6CE8;&#x518C;viewset&#x5230;router&#x91CC;&#x9762;&#xFF0C;&#x8FD9;&#x5C06;&#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210;urlconf&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> myapp.views <span class="hljs-keyword">import</span> UserViewSet
<span class="hljs-keyword">from</span> rest_framework.routers <span class="hljs-keyword">import</span> DefaultRouter

router = DefaultRouter()
router.register(<span class="hljs-string">r&apos;users&apos;</span>, UserViewSet, base_name=<span class="hljs-string">&apos;user&apos;</span>)
urlpatterns = router.urls
</code></pre>
<p>&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x662F;&#x7F16;&#x5199;&#x4F60;&#x81EA;&#x5DF1;&#x7684;<code>viewsets</code>&#xFF0C;&#x800C;&#x662F;&#x4F60;&#x8981;&#x4F7F;&#x7528;&#x4E00;&#x4E9B;&#x73B0;&#x6709;&#x7684;&#x57FA;&#x7C7B;&#x63D0;&#x4F9B;&#x7684;&#x4E00;&#x7EC4;&#x9ED8;&#x8BA4;&#x529F;&#x80FD;&#xFF0C;&#x4F60;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x505A;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserViewSet</span><span class="hljs-params">(viewsets.ModelViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A viewset for viewing and editing user instances.
    &quot;&quot;&quot;</span>
    serializer_class = UserSerializer
    queryset = User.objects.all()
</code></pre>
<p>&#x4F7F;&#x7528;<code>ViewSet</code>&#x7C7B;&#x76F8;&#x6BD4;&#x4F7F;&#x7528;<code>View</code>&#x7C7B;&#xFF0C;&#x6709;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x7684;&#x4F18;&#x70B9;&#xFF1A;</p>
<ul>
<li>&#x91CD;&#x590D;&#x7684;&#x903B;&#x8F91;&#x53EF;&#x4EE5;&#x5408;&#x5E76;&#x5230;&#x4E00;&#x4E2A;&#x7C7B;&#x4E2D;&#x3002;&#x5728;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x5236;&#x5B9A;&#x4E00;&#x6B21;<code>queryset</code>&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5728;&#x591A;&#x4E2A;&#x89C6;&#x56FE;&#x4E2D;&#x4F7F;&#x7528;&#x4E86;&#x3002;</li>
<li>&#x901A;&#x8FC7;&#x4F7F;&#x7528;routers&#xFF0C; &#x6211;&#x4EEC;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x5904;&#x7406;URL&#x914D;&#x7F6E;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x90FD;&#x6709;&#x4E00;&#x4E2A;&#x8FD9;&#x79CD;&#x3002;&#x4F7F;&#x7528;&#x5E38;&#x89C4;&#x7684;&#x89C6;&#x56FE;&#x548C;URL&#x914D;&#x7F6E;&#xFF0C;&#x4F1A;&#x66F4;&#x52A0;&#x6E05;&#x6670;&#x660E;&#x786E;&#xFF0C;&#x5E76;&#x4E14;&#x66F4;&#x5BB9;&#x6613;&#x63A7;&#x5236;&#x3002;&#x4F46;&#x662F;&#x5982;&#x679C;&#x60F3;&#x8981;&#x5FEB;&#x901F;&#x7684;&#x8FD0;&#x884C;&#xFF0C;&#x4F7F;&#x7528;ViewSets&#xFF1B; &#x6216;&#x8005;&#x60A8;&#x6709;&#x5927;&#x91CF;&#x7684;API&#x5E76;&#x4E14;&#x5E0C;&#x671B;&#x59CB;&#x7EC8;&#x6709;&#x4E00;&#x81F4;&#x7684;URL&#x914D;&#x7F6E;&#xFF0C;&#x90A3;&#x4E48;ViewSets&#x5C31;&#x4F1A;&#x5F88;&#x65B9;&#x4FBF;&#x3002;</p>
<h4 id="viewset-&#x5305;&#x542B;&#x7684;&#x52A8;&#x4F5C;">ViewSet &#x5305;&#x542B;&#x7684;&#x52A8;&#x4F5C;</h4>
<p>REST framework&#x4E2D;&#x9ED8;&#x8BA4;&#x7684;&#x8DEF;&#x7531;&#x5668;&#x5C06;&#x4F1A;&#x4E3A; create/retrieve/update/destroy &#x98CE;&#x683C;&#x7684;&#x52A8;&#x4F5C;&#x63D0;&#x4F9B;&#x4E00;&#x7CFB;&#x5217;&#x7684;&#x8DEF;&#x7531;&#xFF0C;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserViewSet</span><span class="hljs-params">(viewsets.ViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x8FD9;&#x662F;&#x4E00;&#x4E2A;viewset &#x7684;&#x6F14;&#x793A;,
    &#x6807;&#x51C6;&#x52A8;&#x4F5C; &#x5C06;&#x4F1A; &#x88AB; &#x8DEF;&#x7531;&#x5668;&#x5904;&#x7406;.

    &#x5982;&#x679C;&#x4F60;&#x4F7F;&#x7528;&#x683C;&#x5F0F;&#x540E;&#x7F00;,
    &#x8BF7;&#x5728;&#x6BCF;&#x4E2A;&#x52A8;&#x4F5C;&#x4E2D;&#x786E;&#x4FDD;,
    &#x5305;&#x542B;&#x4E86;`format=None`&#x5173;&#x952E;&#x5B57;&#x53C2;&#x6570;.
    &quot;&quot;&quot;</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">list</span><span class="hljs-params">(self, request)</span>:</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create</span><span class="hljs-params">(self, request)</span>:</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">retrieve</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">partial_update</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        <span class="hljs-keyword">pass</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">destroy</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        <span class="hljs-keyword">pass</span>
</code></pre>
<p>&#x5728;&#x8C03;&#x5EA6;(<code>dispatch</code>)&#x52A8;&#x4F5C;&#x7684;&#x671F;&#x95F4;&#xFF0C;&#x5F53;&#x524D;&#x7684;&#x52A8;&#x4F5C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>.action</code>&#x5C5E;&#x6027;&#x83B7;&#x53D6;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x68C0;&#x67E5;<code>.action</code>&#x6765;&#x8C03;&#x6574;&#x5F53;&#x524D;&#x52A8;&#x4F5C;&#x7684;&#x884C;&#x4E3A;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x5728;&#x9650;&#x5236;&#x6743;&#x9650;&#x4E3A;&#x5904;&#x7406;<code>list</code>&#x52A8;&#x4F5C;&#x4E4B;&#x5916;&#x7684;&#x5176;&#x4ED6;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_permissions</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Instantiates and returns the list of permissions that this view requires.
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">if</span> self.action == <span class="hljs-string">&apos;list&apos;</span>:
        permission_classes = [IsAuthenticated]
    <span class="hljs-keyword">else</span>:
        permission_classes = [IsAdmin]
    <span class="hljs-keyword">return</span> [permission() <span class="hljs-keyword">for</span> permission <span class="hljs-keyword">in</span> permission_classes]
</code></pre>
<h4 id="&#x8BA9;&#x989D;&#x5916;&#x7684;&#x52A8;&#x4F5C;-&#x4F7F;&#x7528;&#x8DEF;&#x7531;">&#x8BA9;&#x989D;&#x5916;&#x7684;&#x52A8;&#x4F5C; &#x4F7F;&#x7528;&#x8DEF;&#x7531;</h4>
<p>&#x5982;&#x679C;&#x4F60;&#x53C8;&#x989D;&#x5916;&#x7684;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x88AB;&#x8DEF;&#x7531;&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>@detail_route</code>&#x6216;&#x8005;<code>@list_route</code>&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x6765;&#x6807;&#x8BB0;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x53EF;&#x4EE5;&#x88AB;&#x8DEF;&#x7531;&#x3002;</p>
<p>&#x88C5;&#x9970;&#x5668;<code>@detail_route</code>&#x5728;URL&#x4E2D;&#x5339;&#x914D;<code>pk</code>&#x5E76;&#x4E14;&#x9002;&#x7528;&#x4E8E;&#x53EA;&#x9700;&#x8981;&#x5355;&#x4E2A;&#x5B9E;&#x4F8B;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x88C5;&#x9970;&#x5668;<code>@list_route</code>&#x9002;&#x7528;&#x4E8E;&#x9700;&#x8981;&#x64CD;&#x4F5C;&#x4E00;&#x7EC4;&#x5B9E;&#x4F8B;&#x7684;&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x6BD4;&#x5982;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> django.contrib.auth.models <span class="hljs-keyword">import</span> User
<span class="hljs-keyword">from</span> rest_framework <span class="hljs-keyword">import</span> status
<span class="hljs-keyword">from</span> rest_framework <span class="hljs-keyword">import</span> viewsets
<span class="hljs-keyword">from</span> rest_framework.decorators <span class="hljs-keyword">import</span> detail_route, list_route
<span class="hljs-keyword">from</span> rest_framework.response <span class="hljs-keyword">import</span> Response
<span class="hljs-keyword">from</span> myapp.serializers <span class="hljs-keyword">import</span> UserSerializer, PasswordSerializer

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserViewSet</span><span class="hljs-params">(viewsets.ModelViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A viewset that provides the standard actions
    &quot;&quot;&quot;</span>
    queryset = User.objects.all()
    serializer_class = UserSerializer

<span class="hljs-meta">    @detail_route(methods=[&apos;post&apos;])</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_password</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
        user = self.get_object()
        serializer = PasswordSerializer(data=request.data)
        <span class="hljs-keyword">if</span> serializer.is_valid():
            user.set_password(serializer.data[<span class="hljs-string">&apos;password&apos;</span>])
            user.save()
            <span class="hljs-keyword">return</span> Response({<span class="hljs-string">&apos;status&apos;</span>: <span class="hljs-string">&apos;password set&apos;</span>})
        <span class="hljs-keyword">else</span>:
            <span class="hljs-keyword">return</span> Response(serializer.errors,
                            status=status.HTTP_400_BAD_REQUEST)

<span class="hljs-meta">    @list_route()</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">recent_users</span><span class="hljs-params">(self, request)</span>:</span>
        recent_users = User.objects.all().order(<span class="hljs-string">&apos;-last_login&apos;</span>)

        page = self.paginate_queryset(recent_users)
        <span class="hljs-keyword">if</span> page <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">None</span>:
            serializer = self.get_serializer(page, many=<span class="hljs-keyword">True</span>)
            <span class="hljs-keyword">return</span> self.get_paginated_response(serializer.data)

        serializer = self.get_serializer(recent_users, many=<span class="hljs-keyword">True</span>)
        <span class="hljs-keyword">return</span> Response(serializer.data)
</code></pre>
<p>&#x8FD9;&#x4E9B;&#x88C5;&#x9970;&#x5668;&#x8FD8;&#x53EF;&#x4EE5;&#x4E3A;&#x4EC5;&#x4EC5;&#x8DEF;&#x7531;&#x5230;&#x7684;&#x89C6;&#x56FE;&#x4E0A;&#x8BBE;&#x7F6E;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x53C2;&#x6570;&#x3002;&#x6BD4;&#x5982;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-meta">@detail_route(methods=[&apos;post&apos;], permission_classes=[IsAdminOrIsSelf])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_password</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
    ...
</code></pre>
<p>&#x8FD9;&#x4E9B;&#x88C5;&#x9970;&#x5668;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x8DEF;&#x7531;<code>GET</code>&#x8BF7;&#x6C42;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x63A5;&#x6536;&#x5176;&#x4ED6;HTTP&#x65B9;&#x6CD5;&#xFF0C;&#x4F7F;&#x7528;<code>methods</code>&#x53C2;&#x6570;&#x3002;&#x6BD4;&#x5982;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-meta">@detail_route(methods=[&apos;post&apos;, &apos;delete&apos;])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">unset_password</span><span class="hljs-params">(self, request, pk=None)</span>:</span>
    ...
</code></pre>
<p>&#x8FD9;&#x4E24;&#x4E2A;&#x65B0;&#x7684;&#x52A8;&#x4F5C;&#x5C06;&#x4F1A;&#x5728;URL<code>^users/{pk}/set_password/$</code>&#x548C;<code>^users/{pk}/unset_password/$</code>&#x4E2D;&#x53EF;&#x7528;&#x3002;</p>
<h4 id="&#x89E3;&#x6790;url&#x4E2D;&#x7684;&#x52A8;&#x4F5C;">&#x89E3;&#x6790;URL&#x4E2D;&#x7684;&#x52A8;&#x4F5C;</h4>
<p>&#x5982;&#x679C;&#x4F60;&#x9700;&#x8981;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x5E26;&#x6709;&#x52A8;&#x4F5C;&#x7684;URL&#xFF0C;&#x4F7F;&#x7528;<code>.reverse_action()</code>&#x65B9;&#x6CD5;&#x3002;&#x8FD9;&#x662F;&#x5BF9;<code>reverse()</code>&#x7684;&#x4E00;&#x4E2A;&#x4FBF;&#x6377;&#x5C01;&#x88C5;&#xFF0C;&#x5B83;&#x4F1A;&#x81EA;&#x52A8;&#x4F20;&#x9012;&#x89C6;&#x56FE;&#x7684;<code>request</code>&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x5C06;<code>url_name</code>&#x9884;&#x5148;&#x52A0;&#x5165;<code>.basename</code>&#x5C5E;&#x6027;&#x3002;</p>
<p>&#x5173;&#x4E8E;<code>reverser()</code>&#x7684;&#x6587;&#x6863;&#xFF0C;&#x70B9;&#x51FB;<a href="https://docs.djangoproject.com/en/2.0/ref/urlresolvers/" target="_blank">&#x67E5;&#x770B;</a>&#x3002;</p>
<p>&#x6CE8;&#x610F;&#xFF1A;<code>basename</code>&#x662F;&#x5728;<code>ViewSet</code>&#x6CE8;&#x518C;&#x5230;&#x8DEF;&#x7531;&#x7684;&#x65F6;&#x5019;&#x63D0;&#x4F9B;&#x7684;&#x3002;&#x5982;&#x679C;&#x4F60;&#x4E0D;&#x4F7F;&#x7528;<code>router</code>&#xFF0C;&#x90A3;&#x4E48;&#x4F60;&#x5FC5;&#x987B;&#x63D0;&#x4F9B;<code>basename</code>&#x53C2;&#x6570;&#x5230;<code>.as_view()</code>&#x65B9;&#x6CD5;&#x3002;</p>
<p>&#x4F7F;&#x7528;&#x524D;&#x4E00;&#x4E2A;&#x5C0F;&#x7ED3;&#x7684;&#x4F8B;&#x5B50;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-meta">&gt;&gt;&gt; </span>view.reverse_action(<span class="hljs-string">&apos;set-password&apos;</span>, args=[<span class="hljs-string">&apos;1&apos;</span>])
<span class="hljs-string">&apos;http://localhost:8000/api/users/1/set_password&apos;</span>
</code></pre>
<p>&#x53C2;&#x6570;<code>url_name</code>&#x5E94;&#x8BE5;&#x548C;&#x88C5;&#x9970;&#x5668;<code>@list_route</code>&#x548C;<code>@detail_route</code>&#x76F8;&#x5339;&#x914D;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x8FD9;&#x4E5F;&#x53EF;&#x4EE5;&#x88AB;&#x7528;&#x4E8E;<code>reverse</code>&#x9ED8;&#x8BA4;&#x7684;<code>list</code>&#x548C;<code>detail</code>&#x8DEF;&#x7531;&#x3002;</p>
<hr>
<h3 id="api-&#x53C2;&#x8003;">API &#x53C2;&#x8003;</h3>
<p>&#x6E90;&#x7801;&#x4F4D;&#x7F6E;&#xFF1A; <code>rest_framework.viewsets</code></p>
<h4 id="viewset-&#x7C7B;">ViewSet &#x7C7B;</h4>
<p>&#x7C7B;<code>ViewSet</code>&#x662F;<code>APIView</code>&#x7684;&#x5B50;&#x7C7B;&#x3002;&#x6240;&#x4EE5;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EFB;&#x4F55;&#x6807;&#x51C6;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x6BD4;&#x5982;&#x5728;&#x4F60;&#x7684;ViewSet&#x4E2D;&#x4F7F;&#x7528;<code>permission_classes</code>, <code>authentication_classes</code>&#x6765;&#x63A7;&#x5236;API&#x7B56;&#x7565;&#x3002;</p>
<p>&#x7C7B;<code>ViewSet</code>&#x4E2D;&#x5E76;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x4EFB;&#x4F55;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#x6240;&#x4EE5;&#x4F60;&#x5982;&#x679C;&#x8981;&#x4F7F;&#x7528;<code>ViewSet</code>&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>REST framework &#x4E2D;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ViewSet</span><span class="hljs-params">(ViewSetMixin, views.APIView)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    The base ViewSet class does not provide any actions by default.
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>&#x5728;<code>ViewSetMixin</code>&#x548C;<code>APIView</code>&#x4E2D;&#x90FD;&#x6CA1;&#x6709;&#x5173;&#x4E8E;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<h4 id="genericviewset-&#x7C7B;">GenericViewSet &#x7C7B;</h4>
<p>&#x7C7B;<code>GenericViewSet</code>&#x662F;<code>GenericAPIView</code>&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x5E76;&#x4E14;&#x63D0;&#x4F9B;&#x4E86;&#x9ED8;&#x8BA4;&#x7684;<code>get_object</code>&#x548C;<code>get_queryset</code>&#x65B9;&#x6CD5;&#xFF0C;&#x548C;&#x5176;&#x4ED6;&#x901A;&#x7528;&#x7684;&#x89C6;&#x56FE;&#x884C;&#x4E3A;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x5305;&#x62EC;&#x5176;&#x4ED6;&#x4EFB;&#x4F55;&#x9ED8;&#x8BA4;&#x7684;&#x52A8;&#x4F5C;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8981;&#x4F7F;&#x7528;<code>GenericViewSet</code>&#x7C7B;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x91CD;&#x5199;&#x9700;&#x8981;&#x7684;mixin&#x7C7B;&#xFF0C;&#x6216;&#x8005;&#x663E;&#x793A;&#x7684;&#x5B9A;&#x4E49;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<p>REST framework&#x4E2D;&#x6E90;&#x7801;&#x5B9E;&#x73B0;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GenericViewSet</span><span class="hljs-params">(ViewSetMixin, generics.GenericAPIView)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    The GenericViewSet class does not provide any actions by default,
    but does include the base set of generic view behavior, such as
    the `get_object` and `get_queryset` methods.
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>&#x7236;&#x7C7B;<code>ViewSetMixin</code>&#x548C;<code>GenericAPIView</code>&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#x3002;</p>
<h4 id="modelviewset-&#x7C7B;">ModelViewSet &#x7C7B;</h4>
<p>&#x7C7B;<code>ModelViewSet</code>&#x662F;<code>GenericAPIView</code>&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x5E76;&#x4E14;&#x5305;&#x542B;&#x4E86;&#x591A;&#x79CD;&#x591A;&#x6837;&#x7684;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x901A;&#x8FC7;&#x591A;&#x79CD;&#x591A;&#x6837;&#x7684;mixins&#x7C7B;&#x6765;&#x63D0;&#x4F9B;&#x5404;&#x79CD;&#x884C;&#x4E3A;&#x3002;</p>
<p>&#x7C7B;<code>ModelViewSet</code>&#x63D0;&#x4F9B;&#x7684;&#x52A8;&#x4F5C;&#x5305;&#x62EC;<code>.list()</code>, <code>.retrieve()</code>, <code>.create()</code>, <code>.update()</code>, <code>.partial_update()</code>&#x548C;<code>.destroy()</code>&#x3002;</p>
<p><strong>&#x6BD4;&#x5982;</strong></p>
<p>&#x56E0;&#x4E3A;<code>ModelViewSet</code>&#x6269;&#x5C55;&#x4E86;<code>GenericAPIView</code>&#xFF0C;&#x4F60;&#x81F3;&#x5C11;&#x8981;&#x63D0;&#x4F9B;<code>queryset</code>&#x548C;<code>serializer_class</code>&#x5C5E;&#x6027;&#x3002;&#x6BD4;&#x5982;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountViewSet</span><span class="hljs-params">(viewsets.ModelViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A simple ViewSet for viewing and editing accounts.
    &quot;&quot;&quot;</span>
    queryset = Account.objects.all()
    serializer_class = AccountSerializer
    permission_classes = [IsAccountAdminOrReadOnly]
</code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>GenericAPIView</code>&#x7C7B;&#x63D0;&#x4F9B;&#x7684;&#x4EFB;&#x4F55;&#x6807;&#x51C6;&#x7684;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x3002;&#x6BD4;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x8981;&#x52A8;&#x6001;&#x7684;&#x786E;&#x5B9A;&#x67E5;&#x8BE2;&#x7ED3;&#x679C;&#x96C6;&#xFF0C;&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x8FD9;&#x4E48;&#x505A;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountViewSet</span><span class="hljs-params">(viewsets.ModelViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A simple ViewSet for viewing and editing the accounts
    associated with the user.
    &quot;&quot;&quot;</span>
    serializer_class = AccountSerializer
    permission_classes = [IsAccountAdminOrReadOnly]

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_queryset</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">return</span> self.request.user.accounts.all()
</code></pre>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x5F53;&#x4ECE;<code>ViewSet</code>&#x4E2D;&#x5220;&#x9664;<code>queryset</code>&#x5C5E;&#x6027;&#x4E4B;&#x540E;&#xFF0C;&#x4E0E;&#x4E4B;&#x5173;&#x8054;&#x7684;<a href="routers.html"><code>router</code></a>&#x5C06;&#x65E0;&#x6CD5;&#x81EA;&#x52A8;&#x83B7;&#x53D6;&#x4F60;Model&#x7684;<code>base_name</code>&#xFF0C; &#x6240;&#x4EE5;&#x4F60;&#x5FC5;&#x987B;&#x5728;&#x6CE8;&#x518C;&#x8DEF;&#x7531;&#x7684;&#x65F6;&#x5019;&#x8981;&#x81EA;&#x5DF1;&#x6307;&#x5B9A;<code>base_name</code>&#x3002;</p>
<p>&#x63D0;&#x793A;&#xFF1A; <code>base_name</code>&#x662F;&#x6839;&#x636E;<code>viewset</code>&#x4E2D;&#x7684;<code>queryset</code>&#x5C5E;&#x6027;&#x6765;&#x5F97;&#x5230;&#x5F53;&#x524D;&#x64CD;&#x4F5C;&#x7684;&#x6A21;&#x578B;&#x7684;&#x540D;&#x79F0;(&#x5C0F;&#x5199;)</p>
<p>&#x8FD8;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x5C3D;&#x7BA1;&#x8FD9;&#x4E2A;&#x7C7B;&#x9ED8;&#x8BA4;&#x63D0;&#x4F9B;&#x4E86;&#x5B8C;&#x6574;&#x7684;create/list/retrieve/update/destroy&#x64CD;&#x4F5C;&#x96C6;&#xFF0C;&#x4F46;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4F7F;&#x7528;&#x6807;&#x51C6;&#x6743;&#x9650;&#x7C7B;&#x6765;&#x9650;&#x5236;&#x53EF;&#x7528;&#x64CD;&#x4F5C;&#x3002;</p>
<h4 id="readonlymodelviewset-&#x7C7B;">ReadOnlyModelViewSet &#x7C7B;</h4>
<p>&#x7C7B;<code>ReadOnlyModelViewSet</code>&#x7C7B;&#x662F;<code>GenericAPIView</code>&#x7684;&#x4E4B;&#x7C7B;&#xFF0C;&#x8DDF;<code>ModelViewSet</code>&#x7C7B;&#x4E00;&#x6837;&#x4E5F;&#x5305;&#x542B;&#x591A;&#x79CD;&#x52A8;&#x4F5C;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x5305;&#x542B;&#x53EA;&#x8BFB;&#x7684;&#x52A8;&#x4F5C;&#xFF0C;<code>.list()</code>&#x548C;<code>.retrieve()</code>&#x3002;</p>
<p><strong>&#x4F8B;&#x5B50;</strong></p>
<p>&#x548C;<code>ModelViewSet</code>&#x4E00;&#x6837;&#xFF0C; &#x4F60;&#x81F3;&#x5C11;&#x8981;&#x63D0;&#x4F9B;<code>queryset</code>&#x548C;<code>serializer_class</code>&#x5C5E;&#x6027;&#x3002; &#x6BD4;&#x5982; &#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AccountViewSet</span><span class="hljs-params">(viewsets.ReadOnlyModelViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A simple ViewSet for viewing accounts.
    &quot;&quot;&quot;</span>
    queryset = Account.objects.all()
    serializer_class = AccountSerializer
</code></pre>
<p>&#x6B64;&#x5916;&#xFF0C;&#x540C;&#x6837;&#x7684;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>GenericAPIView</code>&#x63D0;&#x4F9B;&#x7684;&#x6807;&#x51C6;&#x7684;&#x5C5E;&#x6027;&#x548C;&#x65B9;&#x6CD5;&#x3002;</p>
<hr>
<h3 id="&#x81EA;&#x5B9A;&#x4E49;viewset-&#x57FA;&#x7840;&#x7C7B;">&#x81EA;&#x5B9A;&#x4E49;ViewSet &#x57FA;&#x7840;&#x7C7B;</h3>
<p>&#x4F60;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x81EA;&#x5B9A;&#x4E49;&#x7684;<code>ViewSet</code>&#x7C7B;&#xFF0C;&#x5E76;&#x4E0D;&#x50CF;<code>ModelViewSet</code>&#x7C7B;&#x4E00;&#x6837;&#x5305;&#x542B;&#x6240;&#x6709;&#x7684;&#x52A8;&#x4F5C;&#xFF0C; &#x6216;&#x8005;&#x81EA;&#x5B9A;&#x4E49;&#x4E00;&#x4E9B;&#x884C;&#x4E3A;&#x3002;</p>
<h4 id="&#x4F8B;&#x5B50;">&#x4F8B;&#x5B50;</h4>
<p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x57FA;&#x7840;&#x7684;viewset&#x7C7B;&#xFF0C;&#x6765;&#x63D0;&#x4F9B;<code>create</code>&#xFF0C;<code>list</code>&#x548C;<code>retrieve</code>&#x64CD;&#x4F5C;&#xFF0C;&#x7EE7;&#x627F;<code>GenericViewSet</code>&#xFF0C;&#x5E76;&#x6DF7;&#x5408;&#x9700;&#x8981;&#x7684;&#x52A8;&#x4F5C;&#xFF1A;</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> rest_framework <span class="hljs-keyword">import</span> mixins

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateListRetrieveViewSet</span><span class="hljs-params">(mixins.CreateModelMixin,
                                mixins.ListModelMixin,
                                mixins.RetrieveModelMixin,
                                viewsets.GenericViewSet)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    A viewset that provides `retrieve`, `create`, and `list` actions.

    To use it, override the class and set the `.queryset` and
    `.serializer_class` attributes.
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>&#x901A;&#x8FC7;&#x521B;&#x5EFA;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x57FA;&#x7840;&#x7684;<code>ViewSet</code>&#x7C7B;&#xFF0C;&#x4F60;&#x53EF;&#x4EE5;&#x63D0;&#x4F9B;&#x5E38;&#x89C1;&#x7684;&#x884C;&#x4E3A;&#xFF0C;&#x7136;&#x540E;&#x5728;&#x4F60;&#x7684;API&#x4E2D;&#x91CD;&#x7528;&#x4ED6;&#x4EEC;&#x3002;</p>
<hr>
<p>&#x53C2;&#x8003;&#x94FE;&#x63A5;&#xFF1A;</p>
<ul>
<li><a href="http://guides.rubyonrails.org/action_controller_overview.html" target="_blank">http://guides.rubyonrails.org/action_controller_overview.html</a></li>
<li><a href="https://docs.djangoproject.com/en/2.0/ref/urlresolvers/" target="_blank">https://docs.djangoproject.com/en/2.0/ref/urlresolvers/</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="gviews.html" class="navigation navigation-prev " aria-label="Previous page: 通用视图Generic views">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="routers.html" class="navigation navigation-next " aria-label="Next page: 路由器Routers">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"视图组Viewsets","level":"4.5","depth":1,"next":{"title":"路由器Routers","level":"4.6","depth":1,"path":"api/routers.md","ref":"api/routers.md","articles":[]},"previous":{"title":"通用视图Generic views","level":"4.4","depth":1,"path":"api/gviews.md","ref":"api/gviews.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-sharing","sharing-plus","search-pro","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"livereload":{},"search-pro":{},"search":{},"sharing-plus":{"qq":false,"all":["facebook","google","twitter","instapaper","linkedin","pocket","stumbleupon"],"douban":false,"facebook":true,"weibo":false,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":true,"messenger":false,"line":false,"vk":false,"pocket":true,"google":false,"viber":false,"stumbleupon":false,"qzone":false,"linkedin":false},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"qq":true,"all":["facebook","google","twitter","weibo","qq","linkedin","qzone","douban"],"douban":false,"facebook":false,"weibo":true,"instapaper":false,"whatsapp":false,"hatenaBookmark":false,"twitter":false,"messenger":false,"line":false,"vk":false,"pocket":false,"google":false,"viber":false,"stumbleupon":false,"qzone":true,"linkedin":false},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true}},"theme":"default","author":"nick","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"GitBook学习笔记","gitbook":"*","description":"Django REST framework 3 中文文档"},"file":{"path":"api/viewsets.md","mtime":"2018-03-17T17:11:50.464Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-03-17T17:48:30.019Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-sharing-plus/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

